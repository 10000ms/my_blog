<!DOCTYPE html>
<html lang="cn">
{% block html %}
  <head>
    {% block head %}
    <title>{% block title %}{{title|default}}{% endblock title %}</title>

    {% block metas %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% endblock metas %}

      {% block other_metas %}
      {% endblock other_metas %}

     <link rel="shortcut icon" href="{{url_for('static', filename='img/favicon.ico')}}" >
    {% block styles %}
    <!-- Bootstrap -->
    <link href="{{bootstrap_find_resource('css/bootstrap.css', cdn='bootstrap')}}" rel="stylesheet">

    {% block background_styles %}
    <style>

        html,body{
            height:100%;
            width:100%;
        }

        .footer{
            background-image:url('/static/img/background.png');
            background-repeat=repeat;
            width:100%;
            height:100px;
            margin-top: -30px;
            box-shadow: 0px 0px 2px 2px #f0f0f0;
        }

        .wrap{
            min-height:100%
        }

        .main{
            padding-bottom:50px;
            overflow:hidden;
        }

        .sidebar{
            position: fixed;
            margin-top:70px;
            height:550px;
            background:#fafafa;
            overflow:hidden;
            box-shadow: 0px 0px 2px 2px #f0f0f0;
            min-width:180px;
        }

        .footer-div{
            color:#FFFFFF;
            text-align:center;
            font-size:16px;
            margin-top: 10px;
        }

        .footer-p-firstline{
            margin-top: 10px;
        }

        canvas{
           position: absolute;
           z-index: -1;
        }

        .content-block{
            background-color:#fafafa;
            overflow:hidden;
            box-shadow: 0px 0px 2px 2px #f0f0f0;
            width: 49%;
            margin-top:70px;
            height:1000px;
            min-width:500px;
        }

    </style>
    {% endblock background_styles %}

    {% block other_styles %}
    {% endblock other_styles %}

    {% endblock styles %}

    {% endblock head %}
  </head>
  <body background-repeat="repeat">
    {% block body %}
    {% block navbar %}

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container text-center">
            <div class="navbar-header">
                <img src="{{url_for('static', filename='img/favicon_black.png')}}" width="50px" height="50px" class="navbar-left">
                <a href="{{url_for('index.index_page')}}" class="navbar-brand">
                    1000ms的小站
                </a>
            </div>
            <div class = "navbar-right">
                <form class="navbar-form navbar-left" role="search" action="{{url_for('index.search_page')}}">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="搜索">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
                        </span>
                    </div>
                </form>
                {% block userpart %}
                {% if current_user.is_authenticated %}
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                            {{ current_user.username }} <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{{url_for('user.login_user_page')}}">个人中心</a></li>
                            <li class="divider"></li>
                            <li><a href="{{url_for('user.logout')}}">退出登陆</a></li>
                        </ul>
                    </li>
                </ul>
                {% else %}
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                            用户 <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{{url_for('user.login_page')}}">登陆</a></li>
                            <li class="divider"></li>
                            <li><a href="{{url_for('user.register_page')}}">注册</a></li>
                        </ul>
                    </li>
                </ul>
                {% endif %}
                {% endblock userpart %}
            </div>
        </div>
    </nav>

    {% endblock navbar %}

    <div class="wrap">
        <div class="main">
            <canvas id="c" width="300" height="150"></canvas>
            {% block sidebar %}
            <div class="sidebar col-md-2 col-md-offset-8">

            </div>
            {% endblock sidebar %}

            {% block content %}

            <div class="content-block col-md-6 col-md-offset-2">
                {% block center_bar %}
                {% endblock center_bar %}

            </div>


            {% endblock content %}
        </div>
    </div>



    {% block footer %}
        <div class="footer">
              <div class="container footer-div">

                  <a href="http://flask.pocoo.org/"><img
                   src="{{url_for('static', filename='img/flask-powered.png')}}"
                   border="0"
                   alt="Flask powered"
                   title="Flask powered"></a>

                <p class="footer-p-firstline">Designed by Victor Lai</p>
              </div>
        </div>
    {% endblock footer %}

    {% block scripts %}
    <script src="{{bootstrap_find_resource('jquery.js', cdn='jquery')}}"></script>
    <script src="{{bootstrap_find_resource('js/bootstrap.js', cdn='bootstrap')}}"></script>

    {% block background_scripts %}
    <script>
        $(document).ready(function() {
            var canvas = document.getElementById("c");
            var ctx = canvas.getContext("2d");
            var c = $("#c");
            var w,h;
            var pi = Math.PI;
            var all_attribute = {
                num:20,            			 // 个数
                start_probability:0.01,		     // 如果数量小于num，有这些几率添加一个新的
                radius_min:1,   			     // 初始半径最小值
                radius_max:2,   			     // 初始半径最大值
                radius_add_min:.1,               // 半径增加最小值
                radius_add_max:.5,               // 半径增加最大值
                opacity_min:0.5,                 // 初始透明度最小值
                opacity_max:0.7, 				 // 初始透明度最大值
                opacity_prev_min:.003,            // 透明度递减值最小值
                opacity_prev_max:.005,            // 透明度递减值最大值
                light_min:85,                 // 颜色亮度最小值
                light_max:100,                 // 颜色亮度最大值
            };
            var style_color = 200;
            var all_element =[];
            window_resize();
            function start(){
                window.requestAnimationFrame(start);
                //style_color+=0.1;  颜色变化
                ctx.fillStyle = 'hsl('+style_color+',20%,99.5%)';
                ctx.fillRect(0, 0, w, h);
                if (all_element.length < all_attribute.num && Math.random() < all_attribute.start_probability){
                    all_element.push(new ready_run);
                }
                all_element.map(function(line) {
                    line.to_step();
                })
            }
            function ready_run(){
                this.to_reset();
            }
            ready_run.prototype = {
                to_reset:function(){
                    var t = this;
                    t.x = find_random(0,w);
                    t.y = find_random(0,h);
                    t.radius = find_random(all_attribute.radius_min,all_attribute.radius_max);
                    t.radius_change = find_random(all_attribute.radius_add_min,all_attribute.radius_add_max);
                    t.opacity = find_random(all_attribute.opacity_min,all_attribute.opacity_max);
                    t.opacity_change = find_random(all_attribute.opacity_prev_min,all_attribute.opacity_prev_max);
                    t.light = find_random(all_attribute.light_min,all_attribute.light_max);
                    t.color = 'hsl('+style_color+',50%,'+t.light+'%)';
                },
                to_step:function(){
                    var t = this;
                    t.opacity -= t.opacity_change;
                    t.radius += t.radius_change;
                    if(t.opacity <= 0){
                        t.to_reset();
                        return false;
                    }
                    ctx.fillStyle = t.color;
                    ctx.globalAlpha = t.opacity;
                    ctx.beginPath();
                    ctx.arc(t.x,t.y,t.radius,0,2*pi,true);
                    ctx.closePath();
                    ctx.fill();
                    ctx.globalAlpha = 1;
                }
            }
            function window_resize(){
                w = window.innerWidth;
                h = $(".main").outerHeight(true);
                canvas.width = w;
                canvas.height = h;
            }
            $(window).resize(function(){
                window_resize();
            });
            function find_random(num_one,num_two){
                return Math.random()*(num_two-num_one)+num_one;
            }
            (function() {
                var lastTime = 0;
                var vendors = ['webkit', 'moz'];
                for(var xx = 0; xx < vendors.length && !window.requestAnimationFrame; ++xx) {
                    window.requestAnimationFrame = window[vendors[xx] + 'RequestAnimationFrame'];
                    window.cancelAnimationFrame = window[vendors[xx] + 'CancelAnimationFrame'] ||
                                                  window[vendors[xx] + 'CancelRequestAnimationFrame'];
                }

                if (!window.requestAnimationFrame) {
                    window.requestAnimationFrame = function(callback, element) {
                        var currTime = new Date().getTime();
                        var timeToCall = Math.max(0, 16.7 - (currTime - lastTime));
                        var id = window.setTimeout(function() {
                            callback(currTime + timeToCall);
                        }, timeToCall);
                        lastTime = currTime + timeToCall;
                        return id;
                    };
                }
                if (!window.cancelAnimationFrame) {
                    window.cancelAnimationFrame = function(id) {
                        clearTimeout(id);
                    };
                }
            }());
            start();
        });

    </script>
    {% endblock background_scripts %}

    {% block other_scripts %}
    {% endblock other_scripts %}

    {% endblock scripts %}
    {% endblock body %}
  </body>
{% endblock html %}
</html>


{#

包含以下block
html：整个html文档
# head：整个head部分
# title：网页标题
# metas：整个meta部分
# other_metas:空白meta部分
# styles：整个style部分
# background_styles：背景部分的css文件
# other_styles：空白styles部分
# body：整个body部分
# navbar：导航条部分
# userpart：导航条中用户部分
# sidebar：边条部分
# content：整体内容部分
# center_bar：中间框内容部分
# footer：页脚部分
# scripts：所有scripts部分
# background_scripts：背景scripts部分
# other_scripts：空白scripts部分

#}